# Lenovo SR675 V3 (7D9R)

## Helpful Links

* [Maintenanace Manual](https://pubs.lenovo.com/sr675-v3/sr675_v3_hardware_maintenance_guide.pdf)
* [Driver Downloads](https://datacentersupport.lenovo.com/us/en/products/servers/thinksystem/sr675v3/7d9r/7d9rctolww/j701ne1z/downloads/driver-list/)
* [Product Guide](https://lenovopress.lenovo.com/lp1611.pdf)
* [Lenovo Knowledge Transfer](https://drive.google.com/drive/u/1/folders/1iixkyIMrfw5Y6JNFq5yaAMyd7vM84pVD)

## Inventory

Slot map:

| | | |
|---|---|---|
|Slot|Component|Location|
|1|NVIDIA DPU|Riser 3 (SW3)|
|3|L40S|Right most slot, right GPU Tray (SW1)|
|4|L40S|Right GPU Tray|
|5|L40S|Right GPU Tray|
|6|L40S|Right GPU Tray|
|7|L40S|Right most slot, left GPU Tray (SW2)|
|8|L40S|Left GPU Tray|
|9|L40S|Left GPU Tray|
|10|L40S|Left GPU Tray|
|15|ConnectX Card|Riser 1|
|16|ConnectX Card|Riser 1|
|20|ConnectX Card|Riser 2|
|21|ConnectX Card|Riser 2|
|30|GPU Tray|Right (SW1)|
|31|GPU Tray|Left (SW2)|

Component inventory:

| | | | | | |
|---|---|---|---|---|---|
| Node Type | Vendor | Model | Component | Description | Quantity |
| GPU | Lenovo | ThinkSystem SR675 V3 OVX | GPU | L40S | 8 |
| | | | DPU | Bluefield 3 | 1 |
| | | | Infiniband | ConnectX-7 (400Gb) x 1 port | 4 |
| | | | CPU | AMD EPYC 9334 @ 3.9 GHz | 2 |
| | | | Memory | 1TB (64GB Sticks) | 16 |
| | | | Disks (boot) | 960GB M2 NVMe SSD | 1 |
| | | | Disks (data) | 3.84TB EDSFF NVMe SSD | 2 |

## Updating Firmware

Lenovo servers can be finicky about updates so when doing firmware updates follow this advice:

* **Always update XCC before UEFI.** You can go from any version to the latest in one go.
* **Always update UEFI while the system is powered off**
* If updating from an old version due to MB replacement:
  * If below [QGE112L-1.30](https://datacentersupport.lenovo.com/us/en/products/servers/thinksystem/sr675v3/7d9r/7d9rctolww/j701lngx/downloads/DS563895)
  , update to 1.30 first, then update to latest

### Firmware Downloads

| | |
|---|---|
| XCC 9.20 | lnvgy\_fw\_xcc\_qgx348j-9.20\_anyos\_comp.zip |
| | [https://datacentersupport.lenovo.com/us/en/products/servers/thinksystem/sr675v3/7d9r/7d9rctolww/downloads/ds573408-lenovo-xclarity-controller-xccbmc-firmware](https://datacentersupport.lenovo.com/us/en/products/servers/thinksystem/sr675v3/7d9r/7d9rctolww/downloads/ds573408-lenovo-xclarity-controller-xccbmc-firmware) |
| UEFI 7.10 | lnvgy\_fw\_uefi\_qge128e-7.10\_anyos\_comp.zip |
| | [https://datacentersupport.lenovo.com/us/en/products/servers/thinksystem/sr675v3/7d9r/7d9rctolww/j701lngx/downloads/DS572559](https://datacentersupport.lenovo.com/us/en/products/servers/thinksystem/sr675v3/7d9r/7d9rctolww/j701lngx/downloads/DS572559) |

## Internal Cabling

By far, the largest issue with the SR675 V3 has to do with issues related to internal cabling.
Due to the flexible nature of the server there are MANY ways to cable the GPUs and risers in the system.

Symptoms of incorrect cabling can include:

* System hang at DXE INIT
* Missing PCIe devices
* PCIe Conn X has encountered a configuration error

The following graphic shows how the data cables should route in the system.

<figure>
<img src=../../static/playbooks/hardware/sr675v3_config38_cabling.png
alt="SR675 V3 MCIO cable routing">
</figure>

More details can be found in the maintenance manual. The SR 675 V3 configuration we use is the
"**8-DW GPU Model cable routing; Configuration 38**" variety which is found starting on page 344 of the
maintenance manual. **I would highly recommend that when dealing with issues that may be related to cabling,
that you provide both the graphic showing the high level system connectivity as well as a link to the maintenance
manual stating they should carefully validate the cabling as shown on pages 344 - 368 for the drive backplane,
GPU distribution boards, rear riser and onboard Ethernet components.**

### Backplane

Cable routing for the E1.S backplane.

<figure>
<img src=../../static/playbooks/hardware/sr675v3_backplane_cable.png
alt="SR675 V3 drive backplane cable routing">
</figure>

### GPU Distribution Board

<figure>
<img src=../../static/playbooks/hardware/sr675v3_gpu_tray_cabling1.png
alt="SR675 V3 MCIO GPU cable routing">
</figure>

<figure>
<img src=../../static/playbooks/hardware/sr675v3_gpu_tray_cabling2.png
alt="SR675 V3 MCIO GPU cable routing">
</figure>

### Rear Risers

<figure>
<img src=../../static/playbooks/hardware/sr675v3_pcie_riser1_cabling.png
alt="SR675 V3 PCIe riser 1 cable routing">
</figure>

<figure>
<img src=../../static/playbooks/hardware/sr675v3_pcie_riser2_cabling.png
alt="SR675 V3 PCIe riser 2 cable routing">
</figure>

### Front I/O expansion board (DPU)

The DPU in the SR675 V3 sits in the front I/O expansion slot. In addition to the data cables for the riser, there is an
auxiliary power cable for the DPU that routes in from riser 1.

<figure>
<img src=../../static/playbooks/hardware/sr675v3_dpu_power_cable.png
alt="DPU aux power cable">
</figure>

The DPU data cables

<figure>
<img src=../../static/playbooks/hardware/sr675v3_dpu_riser_data_cables.png
alt="Front I/O riser data cables">
</figure>
